{% extends "cores/base1.html" %}

{% block title %}
{% if object %}Edit{% else %}Add{% endif %} Menu Item
{% endblock %}

{% block content %}
<div class="container">
  <div class="card shadow-sm p-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">{% if object %}Edit{% else %}Add{% endif %} Menu Item</h4>
    </div>
    <div class="card-body">

      <!-- Display form errors -->
      {% if form.errors %}
      <div class="alert alert-danger">
        <ul>
          {% for field, errors in form.errors.items %}
            {% for error in errors %}
              <li>{{ field }}: {{ error }}</li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row g-3">

          <!-- Category -->
          <div class="col-md-6">
            <label for="id_category" class="form-label">Category</label>
            <select name="category" id="id_category" class="form-select">
              {% for category in categories %}
                <option value="{{ category.id }}" {% if form.category.value == category.id %}selected{% endif %}>
                  {{ category.name }}
                </option>
              {% endfor %}
            </select>
          </div>

          <!-- Name -->
          <div class="col-md-6">
            <label for="id_name" class="form-label">Name</label>
            <input type="text" name="name" id="id_name" class="form-control" value="{{ form.name.value|default_if_none:'' }}">
          </div>

          <!-- SKU -->
          <div class="col-md-6">
            <label for="id_sku" class="form-label">SKU</label>
            <input type="text" name="sku" id="id_sku" class="form-control" value="{{ form.sku.value|default_if_none:'' }}">
          </div>

          <!-- Price -->
          <div class="col-md-6">
            <label for="id_price" class="form-label">Price</label>
            <input type="number" step="0.01" name="price" id="id_price" class="form-control" value="{{ form.price.value|default_if_none:'' }}">
          </div>

          <!-- Tax Rate -->
          <div class="col-md-6">
            <label for="id_tax_rate" class="form-label">Tax Rate</label>
            <input type="number" step="0.01" name="tax_rate" id="id_tax_rate" class="form-control" value="{{ form.tax_rate.value|default_if_none:'' }}">
          </div>

          <!-- Available Checkbox -->
          <div class="col-md-6 form-check mt-4">
            <input type="checkbox" name="is_available" id="id_is_available" class="form-check-input" {% if form.is_available.value %}checked{% endif %}>
            <label class="form-check-label" for="id_is_available">Available</label>
          </div>

          <!-- Image -->
          <div class="col-md-6">
            <label for="id_image" class="form-label">Image</label>
            <input type="file" name="image" id="id_image" class="form-control">
          </div>

          <!-- Created By (readonly) -->
          <div class="col-md-6">
            <label class="form-label">Created By</label>
            <input type="text" class="form-control" value="{{ current_user.username }}" readonly>
          </div>

          <!-- Restaurant -->
          <div class="col-md-6">
            <label for="id_restaurant" class="form-label">Restaurant</label>
            <select name="restaurant" id="id_restaurant" class="form-select">
              {% for restaurant in restaurants %}
                <option value="{{ restaurant.id }}"
                  {% if form.instance.restaurant and form.instance.restaurant.id == restaurant.id %}
                    selected
                  {% endif %}>
                  {{ restaurant.name }}
                </option>
              {% endfor %}
            </select>
          </div>

        </div>

        <div class="mt-4">
          <button type="submit" class="btn btn-success">{% if object %}Update{% else %}Create{% endif %}</button>
          <a href="{% url 'menu:menu_list' %}" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
