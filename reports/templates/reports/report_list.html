{% extends "cores/base1.html" %}
{% block title %}Reports{% endblock %}

{% block content %}
<a href="{% url 'reports:download' %}?filter={{ filter }}" class="btn btn-primary mb-3">
  <i class="material-icons">download</i> Download PDF
</a>

<h2 class="text-primary mb-4">Financial Reports</h2>

<div class="mb-4">
    <a href="?filter=all" class="btn btn-outline-primary {% if filter == 'all' %}active{% endif %}">All Time</a>
    <a href="?filter=daily" class="btn btn-outline-primary {% if filter == 'daily' %}active{% endif %}">Today</a>
    <a href="?filter=weekly" class="btn btn-outline-primary {% if filter == 'weekly' %}active{% endif %}">Last 7 Days</a>
    <a href="?filter=monthly" class="btn btn-outline-primary {% if filter == 'monthly' %}active{% endif %}">Last 30 Days</a>
</div>

{% if reports %}
<div class="row g-4">
    {% for report in reports %}
    <div class="col-md-6">
        <div class="card p-3 shadow-sm h-100">
            <h5 class="mb-3">{{ report.title }}</h5>

            {% if report.content.0 %}
                {% if report.content.0.total or report.content.0.total_qty or report.content.0.quantity or report.content.0.item__name or report.content.0.item__category__name or report.content.0.name %}
                <ul class="list-group list-group-flush">
                    {% for item in report.content %}
                        <li class="list-group-item">
                            {% if item.item__name %}{{ item.item__name }}{% elif item.item__category__name %}{{ item.item__category__name }}{% elif item.name %}{{ item.name }}{% else %}{{ item }}{% endif %}
                            : 
                            {% if item.total %}{{ item.total|floatformat:2 }}{% endif %}
                            {% if item.total_qty %} Qty: {{ item.total_qty }}{% endif %}
                            {% if item.quantity %} Qty: {{ item.quantity }}{% endif %}
                        </li>
                    {% endfor %}
                </ul>
                {% else %}
                    <p class="fs-5">{{ report.content }}</p>
                {% endif %}
            {% else %}
                <p class="fs-5">{{ report.content }}</p>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">No report data available.</div>
{% endif %}
{% endblock %}
